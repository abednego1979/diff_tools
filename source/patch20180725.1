---modify---\myTTS.py
@@ -214,16 +214,47 @@
 pyttsx3%0A
+from pydub import AudioSegment%0A
 %0Aimport 
@@ -3519,16 +3519,17 @@
 name = %22
+_
 tts_samp
@@ -3534,16 +3534,45 @@
 mple.wav
+%22%0A        self.fileprefix = %22
 %22%0A      
@@ -3634,12 +3634,19 @@
 .log
-in()
+State=False
 %0A   
@@ -3791,16 +3791,246 @@
 ), ret)%0A
+        if ret==self.MSP_SUCCESS:%0A            self.logState=True%0A    %0A    def logout(self):%0A        ret = self.dll.MSPLogout()%0A        print(('MSPLogout =%3E'), ret)%0A        if ret==self.MSP_SUCCESS:%0A            self.logState=False%0A
     %0A   
@@ -4296,16 +4296,51 @@
 ce_name%0A
+        self.fileprefix=voice_name%0A
         
@@ -5285,16 +5285,154 @@
 %22, text)
+%0A            %0A        if not self.logState:%0A            self.login()%0A        else:%0A            self.logout()%0A            self.login()%0A    
         
@@ -5473,24 +5473,40 @@
 ), self.file
+prefix+self.file
 name, %22, %22.j
@@ -5551,16 +5551,77 @@
 'utf-8')
+)%0A        %0A        if self.logState:%0A            self.logout(
 )%0A      
@@ -5876,32 +5876,140 @@
 f(ret))%0A        
+if self.dbgFlag:%0A            print ('QTTSSessionBegin =%3E sessionID:', sessionID, 'ret:', ret.value)%0A        
 ret = self.dll.Q
@@ -6053,24 +6053,122 @@
 , None)%0A    
+    if self.dbgFlag:%0A            print ('QTTSTextPut =%3E ret:', ret)%0A            #11212:%E8%AF%95%E7%94%A8%E8%B5%84%E6%BA%90%E8%BF%87%E6%9C%9F%0A    
 %0A        wav
@@ -6238,24 +6238,98 @@
 er)%0A        
+%0A        if self.dbgFlag:%0A            print ('QTTSAudioGet =%3E ',)%0A        
 while True:%0A
@@ -6336,24 +6336,102 @@
             
+self.dll.QTTSAudioGet.restype = POINTER(c_ushort * (1024 * 1024))%0A            
 data = self.
@@ -6527,16 +6527,194 @@
      if 
+self.dbgFlag:%0A                print ('QTTSAudioGet =%3E audio_len:', audio_len.value, 'synth_status:', synth_status.value, 'getret:', getret.value)%0A                %0A            if 
 audio_le
@@ -6740,17 +6740,16 @@
         
-#
 print('d
@@ -6855,32 +6855,172 @@
 elf.MSP_SUCCESS:
+%0A                if self.dbgFlag:%0A                    print ('!MSP_SUCCESS =%3E getret:', getret.value)     #10132:MSP_ERROR_INVALID_OPERATION
 %0A               
@@ -7258,17 +7258,16 @@
         
-#
+
 time.sle
@@ -7625,32 +7625,38 @@
 close()%0A        
+ret = 
 self.dll.QTTSSes
@@ -7682,16 +7682,208 @@
 %22Normal%22
+)%0A        if self.dbgFlag:%0A            print ('QTTSSessionEnd =%3E ret:', ret)%0A        %0A        #trans wav to mp3%0A        myAudioEngine_wav2mp3().trans(filename, filename.replace(%22.wav%22, %22.mp3%22)
 )%0A      
@@ -8356,17 +8356,34 @@
 minate()
+%0A
  
+       f.close()
 %0A       
@@ -8495,200 +8495,75 @@
    %0A
-    %0A#examp
+c
 l
-e%0A%0AText=%22S
 a
-lly 
 s
-ell
 s 
-seashells b
+m
 y
- the seash
+Audi
 o
-re. 1, 2, 3. O
+Engi
 ne
-, T
+_
 w
-o,
+av2mp3():
  
-Three.
  
-The quick bro
+#
 w
-n fox ju
+av%E8%BD%AC
 mp
-ed
+3%E7%9A%84%E5%BC%95%E6%93%8E%0A
  
-over
  
-the
  
-lazy
  d
-og.
+ef
  
-%E6%88%91%E6%98%AF%E4%B8%AD%E5%9B%BD%E4%BA%BA%EF%BC%8C%E5%95%86%E8%B4%BE%E4%BA%91%E9%9B%86%EF%BC%8C%E8%B4%BE%E5%AE%9D%E7%8E%89. 1, 2, 3, 4, 5.%22%0A%0Aeng=myTtsEng
+__
 in
-e_w
 i
-n
+t
 _
-os
 _
-tt
+(
 s
-(
+elf, 
 debu
@@ -8572,301 +8572,174 @@
 lag=
-Tru
+Fals
 e)
+:
 %0A
+        r
 e
+tur
 n
-g.s
+%0A    %0A    d
 e
+f 
 t
-Voices(%22zi
 ra
-%22)%0Ae
 n
-g.
 s
-etSpeechRate
 (
-60)%0Aeng.
 se
-tVo
 l
-ume(1.0)%0Ae
+f, i
 n
-g.say(T
+Fil
 e
-x
+, ou
 t
+File
 )
+:
 %0A
-%0Aeng.setV
+        #v
 oice
-s(%22h
+=A
 u
-ihu
+d
 i
-%22)%0Aeng.set
+o
 S
-p
 e
-echRate(60)%0Aen
 g
-.setVolu
 me
-(1.0)%0Ae
 n
-g.say(Tex
 t
-)%0A%0A%0Aeng=
+.fro
 m
-yTtsEngine
 _w
-in_ked
 a
-xu
+v(i
 n
-fe
+F
 i
-_tts(debugF
 l
-ag=Tru
 e)%0A
+        #voic
 e
-ng
 .
-s
 e
+xpor
 t
-V
+(
 o
+utF
 i
-c
+l
 e
-s(%22xia
+, f
 o
-y
+rm
 a
-n%22)%0Aeng.se
 t
-S
+=%22m
 p
-eechRate(40
+3%22
 )%0A
-eng.s
+        r
 et
-Vol
 u
-me(1.0)%0Ae
+r
 n
-g.say(Text)%0A%0A
---add---\example.py
@@ -0,0 +1,929 @@
+# -*- coding: utf-8 -*-%0A%0A#Python 3.5.x%0A%0A#V0.01%0A%0A#py -3 -m pip install pyttsx3%0A#py -3 -m pip install pypiwin32%0A%0A# https://pypi.org/project/pyttsx3/%0A# more voide packets can download from microsoft website%0A%0A%0Aimport myTTS%0A%0A%0A#example%0A%0AText=%22Sally sells seashells by the seashore. 1, 2, 3. One, Two, Three. The quick brown fox jumped over the lazy dog. %E6%88%91%E6%98%AF%E4%B8%AD%E5%9B%BD%E4%BA%BA%EF%BC%8C%E5%95%86%E8%B4%BE%E4%BA%91%E9%9B%86%EF%BC%8C%E8%B4%BE%E5%AE%9D%E7%8E%89. 1, 2, 3, 4, 5.%22%0AText1=%22Sally sells seashells by the seashore.%22%0AText2=Text1.replace(%22 %22, %22. %22)%0A%0A#eng=myTTS.myTtsEngine_win_os_tts(debugFlag=True)%0A#eng.setVoices(%22zira%22)%0A#eng.setSpeechRate(60)%0A#eng.setVolume(1.0)%0A##eng.say(Text)%0A#eng.say(Text1)%0A#eng.say(Text2)%0A%0A#eng.setVoices(%22huihui%22)%0A#eng.setSpeechRate(60)%0A#eng.setVolume(1.0)%0A#eng.say(Text)%0A%0A%0Aeng=myTTS.myTtsEngine_win_kedaxunfei_tts(debugFlag=True)%0Aeng.setVoices(%22xiaoyan%22)%0Aeng.setSpeechRate(40)%0Aeng.setVolume(1.0)%0Aeng.say(Text)%0A%0Aeng.setVoices(%22yanping%22)%0Aeng.setSpeechRate(40)%0Aeng.setVolume(1.0)%0Aeng.say(Text)%0A%0A%0A
---add---\app_dictation.py
@@ -0,0 +1,323 @@
+# -*- coding: utf-8 -*-%0A%0A#Python 3.5.x%0A%0A#V0.01%0A%0A#%E5%90%AC%E5%86%99%E7%A8%8B%E5%BA%8F%0A%0A#%E6%95%B0%E6%8D%AE%E9%83%BD%E6%94%BE%E5%9C%A8%E4%B8%80%E4%B8%AAexcel%E8%A1%A8%E6%A0%BC%E4%B8%AD%E3%80%82%E5%88%86%E4%B8%BA%E5%8E%9F%E5%A7%8B%E8%AF%8D%E5%8F%A5%EF%BC%8C%E4%BC%98%E5%8C%96%E8%AF%8D%E5%8F%A5-%E4%B8%AD%E8%8B%B1%E6%96%87%E5%8F%AF%E6%B7%B7%E7%BC%96%EF%BC%8C%E5%88%86%E7%BB%84%E6%A0%87%E8%AE%B0%EF%BC%8C%E8%80%83%E8%AF%95%E9%A2%91%E5%BA%A6%EF%BC%8C%E9%85%8D%E5%9B%BE%0A#%E5%85%B6%E4%B8%AD%E4%BC%98%E5%8C%96%E8%AF%8D%E5%8F%A5%E6%98%AF%E7%9B%B8%E5%85%B3%E8%AF%8D%E6%9D%A1%E7%9C%9F%E6%AD%A3%E8%A6%81%E9%80%9A%E8%BF%87TTS%E5%8F%91%E9%9F%B3%E7%9A%84%E4%BF%A1%E6%81%AF%E3%80%82%E9%87%8C%E9%9D%A2%E8%A6%81%E5%AE%9A%E4%B9%89%E4%B8%80%E4%BA%9B%E6%A0%87%E7%AD%BE%EF%BC%8C%E6%AF%94%E5%A6%82%E6%9C%89%E4%BA%9B%E8%A6%81%E6%8C%89%E5%AD%97%E6%AF%8D%E8%80%8C%E4%B8%8D%E6%98%AF%E5%8D%95%E8%AF%8D%E5%8F%91%E9%9F%B3%E3%80%82%E6%9C%89%E4%BA%9BTTS%E5%8F%91%E4%B8%8D%E5%87%BA%E6%9D%A5%E7%9A%84%EF%BC%8C%E7%94%A8%E4%B8%80%E6%AE%B5%E8%AF%AD%E9%9F%B3%E4%BB%A3%E6%9B%BF%0A%0A%0A%0A#%E4%BB%8Esqlite%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE%0Adef readDataFromSqlite():%0A    return%0A%0A%0A#%E5%90%AC%E5%86%99%E7%A8%8B%E5%BA%8F%E3%80%82%E6%A0%B9%E6%8D%AE%E8%BE%93%E5%85%A5%E6%9D%A1%E4%BB%B6%EF%BC%8C%E7%AD%9B%E9%80%89%E5%87%BA%E5%90%AC%E5%86%99%E8%8C%83%E5%9B%B4%E3%80%82%0A#%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90ppt%EF%BC%8C%E8%BF%99%E6%A0%B7%E7%9A%84%E5%A5%BD%E5%A4%84%E6%98%AF%E5%8F%AF%E4%BB%A5%E7%94%A8%E7%8E%B0%E6%88%90%E7%9A%84ppt%E7%9A%84%E5%88%87%E6%8D%A2%E7%AC%94%E5%89%8D%E5%90%8E%E5%88%87%E6%8D%A2%E5%8D%95%E8%AF%8D%E3%80%82%0Adef dictation():%0A    %0A    return%0A%0A%0A
